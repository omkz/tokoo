<%= tag.div(flash[:alert], style: "color:red") if flash[:alert] %>
<%= tag.div(flash[:notice], style: "color:green") if flash[:notice] %>

<h3>Two-factor authentication</h3>
<p>Use a security key to sign in.</p>

<%= form_with(
  scope: :session,
  url: second_factor_authentication_path,
  method: :post,
  data: {
    controller: "webauthn-credentials",
    action: "webauthn-credentials#get:prevent",
    "webauthn-credentials-options-url-value": get_options_second_factor_authentication_path,
  }) do |f| %>
    <%= f.hidden_field :public_key_credential, data: { "webauthn-credentials-target": "credentialHiddenInput" } %>
    <%= f.submit "Use Security Key", disabled: true, data: { "webauthn-credentials-target": "submitButton" } %>
<% end %>
